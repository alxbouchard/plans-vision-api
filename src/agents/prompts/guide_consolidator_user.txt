Produce a final visual guide from the validated data.

PROVISIONAL GUIDE:
{provisional_guide}

STABILITY REPORT:
{stability_report}

MINIMUM STABLE RATIO REQUIRED: {min_stable_ratio}%

You MUST respond with a valid JSON object following this exact structure:

```json
{{
  "guide_generated": true,
  "stable_rules": [
    {{
      "id": "RULE_001",
      "description": "Clear rule description",
      "applies_when": "When/where this rule applies",
      "evidence": "Evidence from validated pages",
      "stability_score": 0.95
    }}
  ],
  "partial_observations": [
    "Observation noted but not validated enough to be a rule"
  ],
  "excluded_rules": [
    {{
      "id": "RULE_003",
      "reason": "Contradicted on page 3"
    }}
  ],
  "limitations": [
    "Known limitation of this guide"
  ],
  "confidence_level": "high | medium | low",
  "rejection_reason": null
}}
```

CRITICAL RULES:
1. If stable rules ratio < {min_stable_ratio}%, set guide_generated=false
2. If guide_generated=false, stable_rules MUST be empty and rejection_reason MUST explain why
3. ONLY include rules marked as STABLE in stable_rules
4. NEVER include unstable or contradicted rules in stable_rules
5. All excluded rules must have a clear reason
6. Be explicit about limitations

REFUSAL CASE:
If you cannot generate a guide, respond with:
```json
{{
  "guide_generated": false,
  "stable_rules": [],
  "partial_observations": [...],
  "excluded_rules": [...],
  "limitations": [],
  "confidence_level": "low",
  "rejection_reason": "Specific explanation of why guide cannot be generated and what is needed"
}}
```

Respond ONLY with the JSON object, no other text.
